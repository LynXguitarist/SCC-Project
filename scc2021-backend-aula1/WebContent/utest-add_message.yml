config:
  target: http://localhost:8080/rest
  plugins:
    metrics-by-endpoint: {
      }
    expect: {
      }
  processor: ../test-utils.js
  variables:
    metricsProcessEndpoint: myProcessEndpoint
  phases:
  - duration: 30
    arrivalCount: 30
    name: "Upload forum"
  - duration: 30
    arrivalCount: 30
    name: "Getting forum"
scenarios:
- name: Upload forum
  weight: 1
  flow:
  - function: genNewMessage
  - post:
      url: /forum
      headers:
        Accept: application/json
      json:
        ownerId: "c5f6213a-9198-4a9c-82df-40365f0ec797"
      capture:
        json: $.id
        as: msgId
      expect:
      - statusCode: 204
- name: Getting forum
  weight: 1
  flow:
  - get:
     url: "/entity/c5f6213a-9198-4a9c-82df-40365f0ec797/forums"
     capture: 
        json: $.id 
        as: msgId 
     expect: 
       - statusCode: 204
  - get:
     url: "/forum/{{ msgId }}"
     expect: 
       statusCode: 204 